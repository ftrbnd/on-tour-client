<p-dialog
  header="Log this concert"
  [modal]="true"
  [(visible)]="visible"
  [style]="{ width: '40rem' }"
>
  <span class="p-text-secondary block mb-8">
    @if (previousConcertLog()){ Update your review} @else { How was
    {{ concert()?.artist?.name }} at {{ concert()?.venue?.name }}? }
  </span>

  <form class="w-full flex flex-col gap-4" [formGroup]="concertLogForm" (ngSubmit)="submit()">
    <p-inputgroup>
      <div class="flex flex-col gap-1 w-full">
        <p-floatlabel variant="on">
          <textarea
            formControlName="review"
            pTextarea
            id="concert_review"
            rows="5"
            cols="30"
            fluid
            class="resize-none"
          ></textarea>
          <label for="concert_review">Review</label>
        </p-floatlabel>

        @if (concertLogForm.dirty && concertLogForm.hasError('maxlength', 'review')) {
        <p-message severity="error" size="small" variant="simple"
          >Must be under 300 characters.</p-message
        >
        }
      </div>
    </p-inputgroup>

    <p-inputgroup class="flex flex-col">
      <div class="flex flex-col gap-1 w-full">
        <label class="text-muted-color" for="rating">Rating</label>
        <p-rating formControlName="rating" />
        @if (concertLogForm.dirty && concertLogForm.hasError('required', 'rating')) {
        <p-message severity="error" size="small" variant="simple"
          >Must be a value from 1-5.</p-message
        >
        }
      </div>
    </p-inputgroup>

    <p-inputgroup class="flex gap-2 items-center">
      <p-togglebutton
        formControlName="liked"
        onLabel="Unlike"
        onIcon="pi pi-heart-fill"
        offLabel="Like"
        offIcon="pi pi-heart"
        size="small"
        ariaLabel="Did you like the concert?"
      />
    </p-inputgroup>

    <div class="flex justify-end gap-2">
      <p-button label="Cancel" severity="secondary" (click)="visible.set(false)" />
      <p-button [disabled]="!concertLogForm.valid" type="submit" label="Save" />
    </div>
  </form>
</p-dialog>
